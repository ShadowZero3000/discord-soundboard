FROM node:14-alpine

RUN apk add --no-cache ffmpeg git

COPY package.json /node/

# node-gyp has to be built in alpine, but not kept for runtime
RUN apk add --no-cache --virtual .build-deps make gcc g++ python \
  && cd /node && npm install --production --silent \
  && apk del .build-deps
